@page "/hr/employee/cruc/{CRUCMode}"
@page "/hr/employee/cruc/{CRUCMode}/{id:int}"
@using DataLayer.GlobalConstant.Pru
@using PruHR = DataLayer.Models.Pru.HR

@* @rendermode InteractiveAuto*@
@inject IDialogService MudDiagSvc
@inherits CRUCPageBase<PruHR.Employee>

@if (CurrentObject != null && CurrentEditContext != null)
{
    <EditForm EditContext="CurrentEditContext" OnValidSubmit="SaveDummy" OnInvalidSubmit="SaveDummy" >
        <DataAnnotationsValidator />
        <MudPaper Class="px-4 py-3 rounded" Width="100%" Elevation="0" Square="true" Style="background-color:var(--pru-cyan-tw-50); border: solid 1px var(--pru-cyan-tw-400)">
            <MudStack Row="true" AlignItems="AlignItems.Center" Justify="Justify.SpaceBetween">
                <div style="color:var(--pru-cyan-default); font-size:28px;">
                    <span style="font-weight:800">@HeaderTitle</span>
                    @if (CRUCMode == CRUDCModes.READ)
                    {
                        <MudChip Size="Size.Small" Color="Color.Success" Class=@($"status-chip-tiny") T="string" Style="margin-top:-5px">View</MudChip>
                    }
                    else if (CRUCMode == CRUDCModes.UPDATE)
                    {
                        <MudChip Size="Size.Small" Color="Color.Info" Class=@($"status-chip-tiny") T="string">Update</MudChip>
                    }
                    else if (CRUCMode == CRUDCModes.CREATE)
                    {
                        <MudChip Size="Size.Small" Color="Color.Info" Class=@($"status-chip-tiny") T="string">New</MudChip>
                    }
                    else if (CRUCMode == CRUDCModes.CLONE)
                    {
                        <MudChip Size="Size.Small" Color="Color.Info" Class=@($"status-chip-tiny") T="string">New (Clone)</MudChip>
                    }
                </div>
                <MudStack Row="true" Spacing="2" AlignItems="AlignItems.Center" Justify="Justify.FlexEnd">
                    @if (!IsViewMode)
                    {
                        <MudButton Variant="Variant.Filled" Size="Size.Small" DropShadow="false" Class="pru-btn-base" Color="Color.Primary" StartIcon="material-symbols-rounded/save_as"
                                   OnClick="@(() => Save())">Save</MudButton>
                        <MudButton Variant="Variant.Filled" Size="Size.Small" DropShadow="false" Class="pru-btn-base" Color="Color.Primary" StartIcon="material-symbols-rounded/save"
                                   OnClick="@(() => Save(true))">Save & Close</MudButton>
                        <MudButton Variant="Variant.Filled" Size="Size.Small" DropShadow="false" Class="pru-btn-base" Color="Color.Secondary" StartIcon="material-symbols-rounded/cancel"
                                   OnClick="Cancel">Cancel</MudButton>
                    }
                    else
                    {
                        <MudButton Variant="Variant.Filled" Size="Size.Small" DropShadow="false" Class="pru-btn-base" Color="Color.Default" StartIcon="material-symbols-rounded/close"
                                   OnClick="Cancel">Close</MudButton>
                    }
                </MudStack>
            </MudStack>
        </MudPaper>
        <MudTabs Class="pru-mud-tab cruc-pg mt-3" Elevation="0">
            <MudTabPanel Text="Main" Icon="material-symbols-rounded/home" Class="pru-mud-tab-panel" Style="min-width:120px">
                <MudPaper Class="px-4 pt-2 pb-5 overflow-y-auto" Height="calc(100vh - 210px)" Width="100%" Elevation="0" Style="position:relative">
                    <MudGrid Spacing="2" Justify="Justify.SpaceEvenly">
                        <MudItem xs="9">
                            <MudTextField ReadOnly="@IsViewMode" Clearable="true" ShrinkLabel="true" FullWidth="true" Class="pru-mud-form-field bordered" Required="true"
                                          Label="Name" 
                                          @bind-Value=CurrentObject!.ObjectName For="@(() => CurrentObject.ObjectName)" OnlyValidateIfDirty="true"
                                          MaxLength="255" />
                        </MudItem>
                        <MudItem xs="2">
                            <MudTextField ReadOnly="@IsViewMode" Clearable="true" ShrinkLabel="true" FullWidth="true" Class="pru-mud-form-field bordered" Required="true"
                                          Label="Employee ID"
                                          @bind-Value=CurrentObject!.EmpID For="@(() => CurrentObject.EmpID)" OnlyValidateIfDirty="true"
                                          MaxLength="25" />
                        </MudItem>
                        <MudItem xs="1">
                            <MudSelect ReadOnly="@IsViewMode" Clearable="true" ShrinkLabel="true" Class="pru-mud-form-field bordered pru-ui-select" PopoverClass="pru-ui-select-popover" Required="true"
                                       Label="LBU" T="string"
                                       Value=CurrentObject!.LBU For="@(() => CurrentObject.LBU)" ValueChanged="OnLBUChanged" OnlyValidateIfDirty="true">
                                @foreach (string lbuID in _lbuIDList)
                                {
                                    <MudSelectItem Value=@lbuID>@lbuID</MudSelectItem>
                                }
                            </MudSelect>
                        </MudItem>
                        <MudItem xs="3">
                            <MudTextField ReadOnly="@IsViewMode" Clearable="true" ShrinkLabel="true" FullWidth="true" Class="pru-mud-form-field bordered"
                                          Label="Surname"
                                          @bind-Value=CurrentObject!.Surname For="@(() => CurrentObject.Surname)" OnlyValidateIfDirty="true" />
                        </MudItem>
                        <MudItem xs="3">
                            <MudTextField ReadOnly="@IsViewMode" Clearable="true" ShrinkLabel="true" FullWidth="true" Class="pru-mud-form-field bordered"
                                          Label="Given Name"
                                          @bind-Value=CurrentObject!.GivenName For="@(() => CurrentObject.GivenName)" OnlyValidateIfDirty="true" />
                        </MudItem>
                        <MudItem xs="3">
                            <MudTextField ReadOnly="@IsViewMode" Clearable="true" ShrinkLabel="true" FullWidth="true" Class="pru-mud-form-field bordered"
                                          Label="Local Name"
                                          @bind-Value=CurrentObject!.LocalName For="@(() => CurrentObject.LocalName)" OnlyValidateIfDirty="true" />
                        </MudItem>
                        <MudItem xs="3">
                            <MudTextField ReadOnly="@IsViewMode" Clearable="true" ShrinkLabel="true" FullWidth="true" Class="pru-mud-form-field bordered"
                                          Label="Call Name"
                                          @bind-Value=CurrentObject!.CallName For="@(() => CurrentObject.CallName)" OnlyValidateIfDirty="true" />
                        </MudItem>
                        <MudItem xs="3">
                            <MudDatePicker ReadOnly=@IsViewMode Clearable="true" ShrinkLabel="true" Editable="true" Class="pru-mud-form-field bordered pru-ui-datepicker"
                                           AdornmentIcon="material-symbols-rounded/calendar_month" AdornmentColor="@Color.Primary"
                                           Label="Date of Birth" DateFormat="dd-MMM-yyyy"
                                           @bind-Date=@CurrentObject.BirthDate For="@(() => CurrentObject.BirthDate)" />
                        </MudItem>
                        <MudItem xs="3">
                            <MudDatePicker ReadOnly=@IsViewMode Clearable="true" ShrinkLabel="true" Editable="true" Class="pru-mud-form-field bordered pru-ui-datepicker"
                                           AdornmentIcon="material-symbols-rounded/calendar_month" AdornmentColor="@Color.Primary"
                                           Label="Joined Date" DateFormat="dd-MMM-yyyy"
                                           @bind-Date=@CurrentObject.JoinedDate For="@(() => CurrentObject.JoinedDate)" />
                        </MudItem>
                        <MudItem xs="3">
                            <MudDatePicker ReadOnly=@IsViewMode Clearable="true" ShrinkLabel="true" Editable="true" Class="pru-mud-form-field bordered pru-ui-datepicker"
                                           AdornmentIcon="material-symbols-rounded/calendar_month" AdornmentColor="@Color.Primary"
                                           Label="Hired Date" DateFormat="dd-MMM-yyyy"
                                           @bind-Date=@CurrentObject.HiredDate For="@(() => CurrentObject.HiredDate)" />
                        </MudItem>
                        <MudItem xs="3">
                            <MudDatePicker ReadOnly=@IsViewMode Clearable="true" ShrinkLabel="true" Editable="true" Class="pru-mud-form-field bordered pru-ui-datepicker"
                                           AdornmentIcon="material-symbols-rounded/calendar_month" AdornmentColor="@Color.Primary"
                                           Label="Last Day" DateFormat="dd-MMM-yyyy"
                                           @bind-Date=@CurrentObject.LastDay For="@(() => CurrentObject.LastDay)" />
                        </MudItem>
                        <MudItem xs="3">
                            <MudTextField ReadOnly="@IsViewMode" Clearable="true" ShrinkLabel="true" FullWidth="true" Class="pru-mud-form-field bordered"
                                          Label="Job Title"
                                          @bind-Value=CurrentObject!.JobTitle For="@(() => CurrentObject.JobTitle)" OnlyValidateIfDirty="true"
                                          MaxLength="255" />
                        </MudItem>
                        <MudItem xs="3">
                            <MudTextField ReadOnly="@IsViewMode" Clearable="true" ShrinkLabel="true" FullWidth="true" Class="pru-mud-form-field bordered"
                                          Label="Job Grade"
                                          @bind-Value=CurrentObject!.JobGrade For="@(() => CurrentObject.JobGrade)" OnlyValidateIfDirty="true"
                                          MaxLength="255" />
                        </MudItem>
                        <MudItem xs="3">
                            <MudTextField ReadOnly="@IsViewMode" Clearable="true" ShrinkLabel="true" FullWidth="true" Class="pru-mud-form-field bordered"
                                          Label="Job Family"
                                          @bind-Value=CurrentObject!.JobFamily For="@(() => CurrentObject.JobFamily)" OnlyValidateIfDirty="true"
                                          MaxLength="255" />
                        </MudItem>
                        <MudItem xs="3">
                            <MudTextField ReadOnly="@IsViewMode" Clearable="true" ShrinkLabel="true" FullWidth="true" Class="pru-mud-form-field bordered"
                                          Label="Job Function"
                                          @bind-Value=CurrentObject!.JobFunction For="@(() => CurrentObject.JobFunction)" OnlyValidateIfDirty="true"
                                          MaxLength="255" />
                        </MudItem>
                        <MudItem xs="3">
                            <MudTextField ReadOnly="@IsViewMode" Clearable="true" ShrinkLabel="true" FullWidth="true" Class="pru-mud-form-field bordered"
                                          Label="Section"
                                          @bind-Value=CurrentObject!.Section For="@(() => CurrentObject.Section)" OnlyValidateIfDirty="true"
                                          MaxLength="255" />
                        </MudItem>
                        <MudItem xs="3">
                            <MudTextField ReadOnly="@IsViewMode" Clearable="true" ShrinkLabel="true" FullWidth="true" Class="pru-mud-form-field bordered"
                                          Label="Division"
                                          @bind-Value=CurrentObject!.Division For="@(() => CurrentObject.Division)" OnlyValidateIfDirty="true"
                                          MaxLength="255" />
                        </MudItem>
                        <MudItem xs="3">
                            <MudTextField ReadOnly="@IsViewMode" Clearable="true" ShrinkLabel="true" FullWidth="true" Class="pru-mud-form-field bordered"
                                          Label="Function"
                                          @bind-Value=CurrentObject!.Function For="@(() => CurrentObject.Function)" OnlyValidateIfDirty="true"
                                          MaxLength="255" />
                        </MudItem>
                        <MudItem xs="3">
                            <MudTextField ReadOnly="@IsViewMode" Clearable="true" ShrinkLabel="true" FullWidth="true" Class="pru-mud-form-field bordered"
                                          Label="Department"
                                          @bind-Value=CurrentObject!.Department For="@(() => CurrentObject.Department)" OnlyValidateIfDirty="true"
                                          MaxLength="255" />
                        </MudItem>
                        <MudItem xs="3">
                            <MudSelect ReadOnly=@IsViewMode Clearable="true" ShrinkLabel="true" Class="pru-mud-form-field bordered pru-ui-select" PopoverClass="pru-ui-select-popover" FullWidth="true"
                                       Label="Worker Type"
                                       @bind-Value=CurrentObject!.WorkerType For="@(() => CurrentObject.EmpStatus)" OnlyValidateIfDirty="true">
                                @foreach (string type in _workerTypeList)
                                {
                                    <MudSelectItem Value=@type>@type</MudSelectItem>
                                }
                            </MudSelect>
                        </MudItem>
                        <MudItem xs="3">
                            <MudSelect ReadOnly=@IsViewMode Clearable="true" ShrinkLabel="true" Class="pru-mud-form-field bordered pru-ui-select" PopoverClass="pru-ui-select-popover" FullWidth="true"
                                       Label="Status"
                                       @bind-Value=CurrentObject!.EmpStatus For="@(() => CurrentObject.EmpStatus)" OnlyValidateIfDirty="true">
                                @foreach (DropdownSelectItem status in _statusList)
                                {
                                    <MudSelectItem Value=@status.Key>@status.Value</MudSelectItem>
                                }
                            </MudSelect>
                        </MudItem>
                        <MudItem xs="6">
                        </MudItem>
                        <MudItem xs="12">
                            <MudTextField ReadOnly="@IsViewMode" Clearable="true" ShrinkLabel="true" FullWidth="true" Class="pru-mud-form-field bordered" Lines=4
                                          Label="Remark" 
                                          @bind-Value=CurrentObject!.Remark For="@(() => CurrentObject!.Remark)" OnlyValidateIfDirty="true"
                                          MaxLines="25" MaxLength="1000" />
                        </MudItem>
                        <MudItem xs="12">
                            <MudDataGrid Class="pru-mud-datagrid mt-2" Dense="true" Hover="true" FixedHeader="true" Striped="true" ReadOnly=@IsViewMode Elevation="0"
                                         T="ITAsset" Items="_itAssetList">
                                <Columns>
                                    @* <PropertyColumn Title="Name" Property="x => x.ObjectName" Sortable="false"
                                                    HeaderClass="pru-mud-datagrid-hdr cruc-pg-items" CellClass="pru-mud-datagrid-cell spacious" /> *@
                                    <TemplateColumn Title="Name" Sortable="false"
                                                    HeaderClass="pru-mud-datagrid-hdr cruc-pg-items" CellClass="pru-mud-datagrid-cell spacious" Context="rowItem">
                                        <CellTemplate>
                                            <MudStack Row=true Spacing="2" AlignItems="AlignItems.Center">
                                                @if (!string.IsNullOrEmpty(@rowItem.Item.SubCategory) && _assetSubCtgIconList.Keys.Contains(@rowItem.Item.SubCategory.ToUpper()))
                                                {
                                                    <MudIcon Icon="@_assetSubCtgIconList[@rowItem.Item.SubCategory.ToUpper()]" Title="@rowItem.Item.SubCategory" Size="Size.Small" />
                                                }
                                                else if (!string.IsNullOrEmpty(@rowItem.Item.CategoryCode) && _assetCategoryIconList.Keys.Contains(@rowItem.Item.CategoryCode))
                                                {
                                                    <MudIcon Icon="@_assetCategoryIconList[rowItem.Item.CategoryCode]" Title="@rowItem.Item.CategoryName" Size="Size.Small" />
                                                }
                                                <MudText Typo="Typo.body1">@rowItem.Item.ObjectName</MudText>
                                            </MudStack>
                                        </CellTemplate>
                                    </TemplateColumn>
                                    <PropertyColumn Title="Product Name" Property="x => x.ProductName" Sortable="false"
                                                    HeaderClass="pru-mud-datagrid-hdr cruc-pg-items" CellClass="pru-mud-datagrid-cell spacious" />
                                    <PropertyColumn Title="Asset Type" Property="x => x.AssetType" Sortable="false"
                                                    HeaderClass="pru-mud-datagrid-hdr cruc-pg-items" CellClass="pru-mud-datagrid-cell spacious" />
                                    <PropertyColumn Title="Category" Property="x => x.CategoryName" Sortable="false"
                                                    HeaderClass="pru-mud-datagrid-hdr cruc-pg-items" CellClass="pru-mud-datagrid-cell spacious" />
                                    <PropertyColumn Title="Sub Category" Property="x => x.SubCategory" Sortable="false"
                                                    HeaderClass="pru-mud-datagrid-hdr cruc-pg-items" CellClass="pru-mud-datagrid-cell spacious" />
                                    <PropertyColumn Title="Serial No." Property="x => x.SerialNo" Sortable="false"
                                                    HeaderClass="pru-mud-datagrid-hdr cruc-pg-items" CellClass="pru-mud-datagrid-cell spacious" />
                                </Columns>
                            </MudDataGrid>
                        </MudItem>
                        @if (CurrentEditContext.GetValidationMessages().Any() || InvalidMsgList.Count > 0)
                        {
                            <MudItem xs="12" Class="pt-10">
                                @foreach (string msg in CurrentEditContext.GetValidationMessages())
                                {
                                    <MudAlert Variant="Variant.Outlined" Severity="Severity.Warning" Dense="true" Icon="material-symbols-rounded/warning" Class="pru-alert-validation mt-2">@msg</MudAlert>
                                }
                                @foreach (string key in InvalidMsgList.Keys)
                                {
                                    <MudAlert Variant="Variant.Outlined" Severity="Severity.Warning" Dense="true" Icon="material-symbols-rounded/warning" Class="pru-alert-validation mt-2">@InvalidMsgList[key]</MudAlert>
                                }
                            </MudItem>
                        }
                    </MudGrid>
                    @if (Id > 0)
                    {
                        <MudStack Row="true" Class="px-2 py-1" AlignItems="AlignItems.Center" Spacing="1" Style="position:absolute; bottom:0; left:0; right:0; background-color:var(--pru-red-tw-50)">
                            <MudText Typo="Typo.body1" Style="font-size:8pt; color:var(--pru-gray-default)">Created By</MudText>
                            <MudText Typo="Typo.body1" Style="font-size:8pt; color:var(--pru-red-default)">@CurrentObject.CreatedUser</MudText>
                            <MudText Typo="Typo.body1" Style="font-size:8pt; color:var(--pru-gray-default)">on</MudText>
                            <MudText Typo="Typo.body1" Style="font-size:8pt; color:var(--pru-red-default)">@(CurrentObject.CreatedDateTime.HasValue? CurrentObject.CreatedDateTime!.Value.ToString("dd-MMM-yyyy hh:mm:ss tt") : " - ")</MudText>
                            <MudText Typo="Typo.body1" Style="font-size:8pt; color:var(--pru-gray-default)"> | Last Modified By</MudText>
                            <MudText Typo="Typo.body1" Style="font-size:8pt; color:var(--pru-red-default)">@CurrentObject.ModifiedUser</MudText>
                            <MudText Typo="Typo.body1" Style="font-size:8pt; color:var(--pru-gray-default)">on</MudText>
                            <MudText Typo="Typo.body1" Style="font-size:8pt; color:var(--pru-red-default)">@(CurrentObject.ModifiedDateTime.HasValue? CurrentObject.ModifiedDateTime!.Value.ToString("dd-MMM-yyyy hh:mm:ss tt") : " - ")</MudText>
                        </MudStack>
                    }
                </MudPaper>
            </MudTabPanel>
            <MudTabPanel Text="History" Icon="material-symbols-rounded/history" Class="pru-mud-tab-panel" Style="min-width:120px">
                <MudPaper Class="px-4 pt-2 pb-5 overflow-y-auto" Height="calc(100vh - 210px)" Width="100%" Elevation="0" Style="position:relative">
                    
                </MudPaper>
            </MudTabPanel>
        </MudTabs>
    </EditForm>
}


@code {
    #region UI PARAM
    string _dataGridHdrStyle = "font-weight:700; background-color:var(--pru-gray-default); color:#FFFFFF; border-right:1px solid #FFFFFF; padding-inline-start: 10px; padding-inline-end:5px; line-height:100%; padding-top:4px; padding-bottom:4px";
    IEnumerable<DropdownSelectItem> _lbuList = Enumerable.Empty<DropdownSelectItem>();
    IEnumerable<string> _lbuIDList = ["PCLA", "PMLI", "PLAL"];
    IEnumerable<DropdownSelectItem> _statusList = EmployeeStatuses.GetForDropdown();
    IEnumerable<string> _workerTypeList = ["FTE", "FC", "Agency", "Contract Staff", "Outsourced"];
    IEnumerable<ITAsset> _itAssetList = [];
    Dictionary<string, string> _assetCategoryIconList = new Dictionary<string, string> {
        { "LAPTOP", "material-symbols-rounded/laptop" },
        { "VDI", "material-symbols-rounded/desktop_cloud" },
        { "MOBILE", "material-symbols-rounded/mobile" },
        { "SMART-PHONE", "material-symbols-rounded/mobile_2" },
        { "DESKTOP", "material-symbols-rounded/desktop_windows" },
        { "IPAD", "material-symbols-rounded/tablet_mac" },
    };

    Dictionary<string, string> _assetSubCtgIconList = new Dictionary<string, string> {
        { "MOBILE", "material-symbols-rounded/sim_card" },
    };

    Dictionary<string, string> _statusCssClassList = new()
        {
            { "", "" },
            { AssetLifeCycleStatuses.IN_STOCK, "status-chip-success-light" },
            { AssetLifeCycleStatuses.IN_USE, "status-chip-success-light" },
            { AssetLifeCycleStatuses.WRITTEN_OFF, "status-chip-obsolete-light" },
            { AssetLifeCycleStatuses.PENDING_WRITE_OFF, "status-chip-pending-light" },
            { AssetLifeCycleStatuses.PENDING_TERMINATION, "status-chip-pending-light" },
        };

    Dictionary<string, string> _stateCssClassList = new()
    {
        { "", "" },
        { AssetStates.BRAND_NEW, "status-chip-success-light" },
        { AssetStates.USED_GOOD, "status-chip-success-light" },
        { AssetStates.USED_POOR, "status-chip-obsolete-light" },
        { AssetStates.USED_ESR, "status-chip-pending-light" },
        { AssetStates.EOL, "status-chip-obsolete-light" },
        { AssetStates.BROKEN_UNREPAIRABLE, "status-chip-pending-light" },
        { AssetStates.NA, "status-chip-pending-light" }
    };
    #endregion

    #region PAGE LIFECYCLE FUNCTIONS
    public override Task SetParametersAsync(ParameterView parameters)
    {
        UrlPrefix = "/hr/employee";

        return base.SetParametersAsync(parameters);
    }

    protected override async Task OnInitializedAsync()
    {
        switch(CRUCMode)
        {
            case CRUCModes.READ:
                {
                    CurrentObject = await Uow.Employees.GetAsync(Id);
                    IsViewMode = true;
                }
                break;
            case CRUCModes.CREATE:
                {
                    CurrentObject = new();
                }
                break;
            case CRUCModes.UPDATE:
                CurrentObject = await Uow.Employees.GetAsync(Id);
                break;
            case CRUCModes.CLONE:
                {
                    var tempObj = await Uow.Employees.GetAsync(Id);
                    CurrentObject = tempObj.DeepClone();
                    CurrentObject!.Id = 0;
                    CurrentObject!.ObjectCode = String.Empty;
                } break;
        }

        CurrentEditContext = new EditContext(CurrentObject!);

        HeaderTitle = ObjectDisplayName;
        await PopulateUIControl();
    }
    #endregion

    #region UI FUNCTIONS
    private async Task OnLBUChanged(string lbu)
    {
        CurrentObject!.LBU = lbu;
        await Task.CompletedTask;
    }
    #endregion

    #region UPDATE FUNCTIONS
    protected override async Task PreSaveProcessing()
    {
        CurrentObject!.ObjectCode = CurrentObject!.EmpID;
        CurrentObject!.ObjectCode = CurrentObject!.ObjectCode!.ToUpper();
        await Task.CompletedTask;
    }

    protected override async Task ValidatePreSave()
    {
        InvalidMsgList.Clear();

        bool isDuplicated = await Uow.ITAssets.IsDuplicateCodeAsync(CurrentObject!.Id, CurrentObject!.ObjectCode!);

        if (isDuplicated)
        {
            InvalidMsgList.Add("ObjectCode_Duplicate", $"Asset with ID='{CurrentObject.ObjectCode}' is already existed.");
        }
    }

    protected override async Task<bool> SaveAndCommitProcessing()
    {
        DateTime timestamp = DateTime.Now;

        if (CurrentObject!.Id == 0)   //create
        {
            CurrentObject!.CreatedUser = AuditTrailUser;
            CurrentObject!.ModifiedUser = AuditTrailUser;
            CurrentObject!.CreatedDateTime = timestamp;
            CurrentObject!.ModifiedDateTime = timestamp;

            int objId = await Uow.Employees.InsertAsync(CurrentObject!);

            if (objId > 0)
            {
                CurrentObject!.Id = objId;
                return true;
            }
            else
                return false;
        }
        else    // update
        {
            CurrentObject!.ModifiedUser = AuditTrailUser;
            CurrentObject!.ModifiedDateTime = DateTime.Now;

            bool isupdated = await Uow.Employees.UpdateAsync(CurrentObject!);
            return isupdated;
        }
    }
    #endregion

    #region INTERNAL FUNCTION
    async Task PopulateUIControl()
    {
        _lbuList = PruLBUs.GetForDropdown();

        if (!string.IsNullOrEmpty(CurrentObject!.EmpID))
            _itAssetList = await Uow.ITAssets.GetByEmployeeAsync(CurrentObject!.EmpID!);
    }
    #endregion
}